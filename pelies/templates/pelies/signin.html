{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - Hales Flowers</title>
    <link rel="stylesheet" href="{% static 'css/signin.css' %}">
</head>
<body>

<div class="signin-container">
    <h2>Sign In</h2>

    {% if messages %}
        <div class="error-messages">
            {% for message in messages %}
                <p>{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <form method="POST" action="{% url 'signin' %}">
        {% csrf_token %}
        <input type="text" name="username" placeholder="Email or Username" class="form-input" required>
        <input type="password" name="password" placeholder="Password" class="form-input" required>
        <button type="submit" class="signin-btn">Sign In</button>
    </form>

    <div class="signin-links">
        Don't have an account? <a href="{% url 'signup' %}">Create one</a>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form');

    function getErrorContainer(input) {
        let errorSpan = input.nextElementSibling;
        if (!errorSpan || !errorSpan.classList.contains('error-text')) {
            errorSpan = document.createElement('span');
            errorSpan.className = 'error-text';
            errorSpan.style.color = '#a30000';
            errorSpan.style.fontSize = '13px';
            errorSpan.style.display = 'block';
            errorSpan.style.marginTop = '-10px';
            errorSpan.style.marginBottom = '10px';
            input.insertAdjacentElement('afterend', errorSpan);
        }
        return errorSpan;
    }

    form.addEventListener('submit', function(event) {
        let valid = true;
        form.querySelectorAll('.error-text').forEach(e => e.textContent = '');

        const username = form.username.value.trim();
        const password = form.password.value;

        if (username.length === 0) {
            getErrorContainer(form.username).textContent = 'First Name (username) is required.';
            valid = false;
        } else if (username.includes(' ')) {
            getErrorContainer(form.username).textContent = 'First Name cannot contain spaces.';
            valid = false;
        }

        if (password.length === 0) {
            getErrorContainer(form.password).textContent = 'Password is required.';
            valid = false;
        }

        if (!valid) {
            event.preventDefault();
        }
    });
});
</script>
</body>
</html>
